<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="å¹´è½»ä¸”ä¼˜ç§€ï¼Œé¢“åºŸä¸”ç§¯æ">
    

    <!--Author-->
    
        <meta name="author" content="å¶ä¸€ç‰‡">
    

    <!-- Title -->
    
    <title>Hive | æˆ‘æ˜¯å¶ä¸€ç‰‡</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.jsdelivr.net/npm/bootstrap@3.3.6/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//cdn.jsdelivr.net/npm/font-awesome@4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Noto+Serif:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- jQuery -->
    <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="//cdn.jsdelivr.net/npm/bootstrap@3.3.6/dist/js/bootstrap.min.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="æˆ‘æ˜¯å¶ä¸€ç‰‡" type="application/atom+xml">
</head>


<body>

    <!-- Content -->
    <section class="article-container">
    <!-- Back Home -->
    <a class="nav-back" href="/">
    <i class="fa fa-puzzle-piece"></i>
</a>

        <!-- Page Header -->
        <header class="intro-header">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <div class="post-heading">
                            <h1>
                                Hive
                            </h1>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Post Content -->
        <article>
            <div class="container">
                <div class="row">
                    <!-- Post Main Content -->
                    <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <p>Studentsè¡¨åœ¨Hiveçš„å¤šè¡¨æŸ¥è¯¢</p>
<span id="more"></span>

<h2 id="1-èµ„æ–™å‡†å¤‡"><a href="#1-èµ„æ–™å‡†å¤‡" class="headerlink" title="1.èµ„æ–™å‡†å¤‡"></a>1.èµ„æ–™å‡†å¤‡</h2><p>èµ„æ–™ä¸‹è½½ï¼š<a target="_blank" rel="noopener" href="https://wwyl.lanzoum.com/isI3P0zrssnc">https://wwyl.lanzoum.com/isI3P0zrssnc</a></p>
<p>å­—æ®µè§£é‡Šï¼š</p>
<p>è¯¾ç¨‹è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th align="center">CODE</th>
<th align="center">NAME</th>
<th align="center">PERIOD</th>
<th align="center">CREDIT</th>
</tr>
</thead>
<tbody><tr>
<td align="center">è¯¾ç¨‹ç¼–å·</td>
<td align="center">è¯¾ç¨‹åç§°</td>
<td align="center">è¯¾æ—¶</td>
<td align="center">å­¦åˆ†</td>
</tr>
</tbody></table>
<p>ä»»è¯¾è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th align="center">CODE</th>
<th align="center">SEMESTER</th>
<th align="center">TEACHER_ID</th>
<th align="center">COURSE_CODE</th>
</tr>
</thead>
<tbody><tr>
<td align="center">è¯¾ç¨‹ç¼–å·</td>
<td align="center">å­¦æœŸ</td>
<td align="center">ä»»è¯¾è€å¸ˆç¼–å·</td>
<td align="center">ä¸ä¸Šè¡¨CODEå¯¹åº”</td>
</tr>
</tbody></table>
<p>ä¸“ä¸šè¡¨</p>
<table>
<thead>
<tr>
<th align="center">ID</th>
<th align="center">COLLEGE</th>
<th align="center">MAJOR</th>
<th align="center">GRADE</th>
<th align="center">CLASS</th>
<th align="center">TYPE</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ç¼–å·</td>
<td align="center">å­¦é™¢</td>
<td align="center">å­¦å·</td>
<td align="center">å¹´çº§</td>
<td align="center">ç­çº§</td>
<td align="center">ç±»å‹</td>
</tr>
</tbody></table>
<p>å­¦ç”Ÿè¡¨</p>
<table>
<thead>
<tr>
<th align="center">ID</th>
<th align="center">NAME</th>
<th align="center">GENDER</th>
<th align="center">BIRTHDATE</th>
<th align="center">PHONENUMBER</th>
<th align="center">MAJOR_CLASS</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å­¦ç”Ÿç¼–å·</td>
<td align="center">å§“å</td>
<td align="center">æ€§åˆ«</td>
<td align="center">ç”Ÿæ—¥</td>
<td align="center">æ‰‹æœºå·</td>
<td align="center">ä¸“ä¸šç­çº§</td>
</tr>
</tbody></table>
<p>é€‰è¯¾è¡¨</p>
<table>
<thead>
<tr>
<th align="center">COURSE_CLASS_CODE</th>
<th align="center">STUDENT_ID</th>
<th align="center">SCORE</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ä¸è¡¨2çš„CODEå¯¹åº”</td>
<td align="center">å­¦ç”Ÿç¼–å·</td>
<td align="center">æˆç»©</td>
</tr>
</tbody></table>
<p>æ•™å¸ˆè¡¨</p>
<table>
<thead>
<tr>
<th align="center">ID</th>
<th align="center">NAME</th>
<th align="center">GENDER</th>
<th align="center">TITLE</th>
</tr>
</thead>
<tbody><tr>
<td align="center">æ•™å¸ˆç¼–å·</td>
<td align="center">å§“å</td>
<td align="center">æ€§åˆ«</td>
<td align="center">èŒç§°</td>
</tr>
</tbody></table>
<h2 id="2-æ—¥å¸¸æ“ä½œ"><a href="#2-æ—¥å¸¸æ“ä½œ" class="headerlink" title="2.æ—¥å¸¸æ“ä½œ"></a>2.æ—¥å¸¸æ“ä½œ</h2><h3 id="ï¼ˆ1ï¼‰å¯åŠ¨ã€æ–°å»ºæ–‡ä»¶å¤¹"><a href="#ï¼ˆ1ï¼‰å¯åŠ¨ã€æ–°å»ºæ–‡ä»¶å¤¹" class="headerlink" title="ï¼ˆ1ï¼‰å¯åŠ¨ã€æ–°å»ºæ–‡ä»¶å¤¹"></a>ï¼ˆ1ï¼‰å¯åŠ¨ã€æ–°å»ºæ–‡ä»¶å¤¹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">start-all.sh</span><br><span class="line">hadoop fs -mkdir /hadoop_class/student_data</span><br></pre></td></tr></table></figure>

<h3 id="ï¼ˆ2ï¼‰copyFromLocal"><a href="#ï¼ˆ2ï¼‰copyFromLocal" class="headerlink" title="ï¼ˆ2ï¼‰copyFromLocal"></a>ï¼ˆ2ï¼‰copyFromLocal</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -copyFromLocal ~/student/tb_course.csv /hadoop_class/student_data</span><br><span class="line">hadoop fs -copyFromLocal ~/student/tb_course_class.csv /hadoop_class/student_data</span><br><span class="line">hadoop fs -copyFromLocal ~/student/tb_major_class.csv /hadoop_class/student_data</span><br><span class="line">hadoop fs -copyFromLocal ~/student/tb_student.csv /hadoop_class/student_data</span><br><span class="line">hadoop fs -copyFromLocal ~/student/tb_electives.csv /hadoop_class/student_data</span><br><span class="line">hadoop fs -copyFromLocal ~/student/tb_teacher.csv /hadoop_class/student_data</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive</span><br><span class="line">use username;/*æˆ‘è¿™æ¬¡æ²¡ç”¨*/</span><br></pre></td></tr></table></figure>

<h3 id="ï¼ˆ3ï¼‰å»ºè¡¨"><a href="#ï¼ˆ3ï¼‰å»ºè¡¨" class="headerlink" title="ï¼ˆ3ï¼‰å»ºè¡¨"></a>ï¼ˆ3ï¼‰å»ºè¡¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/*course*/</span><br><span class="line">CREATE EXTERNAL TABLE IF NOT EXISTS course(CODE string,NAME string,PERIOD int,CREDIT int)</span><br><span class="line">row format serde &#x27;org.apache.hadoop.hive.serde2.OpenCSVSerde&#x27;</span><br><span class="line">stored as textfile</span><br><span class="line"></span><br><span class="line">load data inpath &#x27;/hadoop_class/student_data/tb_course.csv&#x27; overwrite into table course;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/*course_class*/</span><br><span class="line">CREATE EXTERNAL TABLE IF NOT EXISTS course_class(CODE string,SEMESTER string,TEACHER_ID int,COURSE_CODE string)</span><br><span class="line">row format serde &#x27;org.apache.hadoop.hive.serde2.OpenCSVSerde&#x27;</span><br><span class="line">stored as textfile</span><br><span class="line"></span><br><span class="line">load data inpath &#x27;/hadoop_class/student_data/tb_course_class.csv&#x27; overwrite into table course_class;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/*major_class*/</span><br><span class="line">CREATE EXTERNAL TABLE IF NOT EXISTS major_class(ID int,COLLEGE string,MAJOR string,GRADE int,CLASS int,TYPE string)</span><br><span class="line">row format serde &#x27;org.apache.hadoop.hive.serde2.OpenCSVSerde&#x27;</span><br><span class="line">stored as textfile;</span><br><span class="line"></span><br><span class="line">load data inpath &#x27;/hadoop_class/student_data/tb_major_class.csv&#x27; overwrite into table major_class;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/*students*/</span><br><span class="line">CREATE EXTERNAL TABLE IF NOT EXISTS students(ID int,NAME string,GENDER string,BIRTHDATE string,PHONENUMBER string,MAJOR_CLASS int)</span><br><span class="line">row format serde &#x27;org.apache.hadoop.hive.serde2.OpenCSVSerde&#x27;</span><br><span class="line">stored as textfile;</span><br><span class="line"></span><br><span class="line">load data inpath &#x27;/hadoop_class/student_data/tb_student.csv&#x27; overwrite into table students;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/*electives*/</span><br><span class="line">CREATE EXTERNAL TABLE IF NOT EXISTS electives(COURSE_CLASS_CODE string,STUDENT_ID int,SCORE int)</span><br><span class="line">row format serde &#x27;org.apache.hadoop.hive.serde2.OpenCSVSerde&#x27;</span><br><span class="line">stored as textfile;</span><br><span class="line"></span><br><span class="line">load data inpath &#x27;/hadoop_class/student_data/tb_electives.csv&#x27; overwrite into table electives;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/*teacher*/</span><br><span class="line">CREATE EXTERNAL TABLE IF NOT EXISTS teacher(ID int,NAME string,GENDER string,TITLE string)</span><br><span class="line">row format serde &#x27;org.apache.hadoop.hive.serde2.OpenCSVSerde&#x27;</span><br><span class="line">stored as textfile;</span><br><span class="line"></span><br><span class="line">load data inpath &#x27;/hadoop_class/student_data/tb_teacher.csv&#x27; overwrite into table teacher;</span><br></pre></td></tr></table></figure>

<h3 id="ï¼ˆ4ï¼‰é¢˜ç›®-å»è¡¨å¤´"><a href="#ï¼ˆ4ï¼‰é¢˜ç›®-å»è¡¨å¤´" class="headerlink" title="ï¼ˆ4ï¼‰é¢˜ç›®[å»è¡¨å¤´]"></a>ï¼ˆ4ï¼‰é¢˜ç›®[å»è¡¨å¤´]</h3><p>1ã€åˆ†ææ•°æ®ï¼š<br>   aã€ç”·å¥³ç”Ÿæ¯”ä¾‹<br>   bã€å­¦ç”Ÿæ•´ä½“åŠæ ¼ç‡<br>   cã€æ¯é—¨è¯¾ç¨‹çš„å¹³å‡åˆ†ï¼Œè¦æ±‚æ˜¾ç¤ºå‡ºè¯¾ç¨‹çš„ä¸­æ–‡åå­—<br>   dã€æœ‰2é—¨è¯¾ä¸åŠæ ¼çš„å­¦ç”Ÿï¼ˆé‡ä¿®çš„å­¦ç”Ÿï¼‰<br>   eã€è¯¾ç¨‹çš„åŠæ ¼ç‡ï¼ŒåŒæ—¶è¦æ˜¾ç¤ºè€å¸ˆçš„åå­—ï¼ˆç»©æ•ˆè€ƒæ ¸ï¼‰</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> course <span class="keyword">set</span> TBLPROPERTIES(&quot;skip.header.line.count&quot;<span class="operator">=</span>&quot;1&quot;);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> course_class <span class="keyword">set</span> TBLPROPERTIES(&quot;skip.header.line.count&quot;<span class="operator">=</span>&quot;1&quot;);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> major_class <span class="keyword">set</span> TBLPROPERTIES(&quot;skip.header.line.count&quot;<span class="operator">=</span>&quot;1&quot;);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">set</span> TBLPROPERTIES(&quot;skip.header.line.count&quot;<span class="operator">=</span>&quot;1&quot;);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> electives <span class="keyword">set</span> TBLPROPERTIES(&quot;skip.header.line.count&quot;<span class="operator">=</span>&quot;1&quot;);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> teacher <span class="keyword">set</span> TBLPROPERTIES(&quot;skip.header.line.count&quot;<span class="operator">=</span>&quot;1&quot;);</span><br><span class="line"><span class="comment">/*å› ä¸ºç¬¬ä¸€è¡Œæœ‰è¡¨å¤´ ä¼šå½±å“æ•°æ®*/</span></span><br></pre></td></tr></table></figure>

<h2 id="3-è§£é¢˜"><a href="#3-è§£é¢˜" class="headerlink" title="3.è§£é¢˜"></a>3.è§£é¢˜</h2><h3 id="aã€ç”·å¥³ç”Ÿæ¯”ä¾‹"><a href="#aã€ç”·å¥³ç”Ÿæ¯”ä¾‹" class="headerlink" title="aã€ç”·å¥³ç”Ÿæ¯”ä¾‹"></a>aã€ç”·å¥³ç”Ÿæ¯”ä¾‹</h3><p>æ–¹æ³•ä¸€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT GENDER,count(*),100*count(*)/SUM(count(*)) over()</span><br><span class="line">FROM students</span><br><span class="line">GROUP BY GENDER;</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/649463e91ddac507cc527265.jpg"></p>
<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select t1.male/t2.female from</span><br><span class="line">(select count(1) as male from students where GENDER=&#x27;ç”·&#x27;) t1,</span><br><span class="line">(select count(1) as female from students where GENDER=&#x27;å¥³&#x27;) t2 where 1=1;</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/649463ff1ddac507cc5296e2.jpg"></p>
<h3 id="bã€å­¦ç”Ÿæ•´ä½“åŠæ ¼ç‡"><a href="#bã€å­¦ç”Ÿæ•´ä½“åŠæ ¼ç‡" class="headerlink" title="bã€å­¦ç”Ÿæ•´ä½“åŠæ ¼ç‡"></a>bã€å­¦ç”Ÿæ•´ä½“åŠæ ¼ç‡</h3><p>æ–¹æ³•ä¸€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">CREATE TEMPORARY TABLE temp1 AS</span><br><span class="line">SELECT COURSE_CLASS_CODE, COUNT(*) AS totlsum </span><br><span class="line">FROM electives </span><br><span class="line">WHERE SCORE&gt;=60</span><br><span class="line">GROUP BY COURSE_CLASS_CODE;</span><br><span class="line"></span><br><span class="line">CREATE TEMPORARY TABLE temp2 AS</span><br><span class="line">SELECT COURSE_CLASS_CODE, COUNT(*) AS totlsum2 </span><br><span class="line">FROM electives </span><br><span class="line">GROUP BY COURSE_CLASS_CODE;</span><br><span class="line"></span><br><span class="line">SELECT temp1.COURSE_CLASS_CODE,CONCAT(CAST(temp1.totlsum*100/temp2.totlsum2 AS DECIMAL(10,2)),&#x27;%&#x27;)</span><br><span class="line">FROM temp1,temp2</span><br><span class="line">WHERE temp1.COURSE_CLASS_CODE=temp2.COURSE_CLASS_CODE;</span><br><span class="line">/*SELECT CONCAT(CAST(value AS DECIMAL(10,2)), &#x27;%&#x27;) FROM table_name;</span><br><span class="line">æ‰§è¡Œä»¥ä¸Š HiveQL æŸ¥è¯¢åï¼Œè¿”å›çš„ç»“æœä¼šå°† value åˆ—ä¸­çš„æ‰€æœ‰æ•°å€¼æ ¼å¼åŒ–ä¸ºä¿ç•™ä¸¤ä½å°æ•°å¹¶æ·»åŠ ç™¾åˆ†å·çš„å½¢å¼*/</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/649464081ddac507cc52a3be.jpg"></p>
<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT t1.pass/t2.total </span><br><span class="line">FROM (SELECT COUNT(1) as pass </span><br><span class="line">      FROM electives </span><br><span class="line">      WHERE SCORE &lt;60)t1,</span><br><span class="line">      (SELECT COUNT(1) as total </span><br><span class="line">      FROM electives)t2;</span><br><span class="line">      </span><br><span class="line">SELECT ROUND(SUM(IF(SCORE&gt;=60,1,0))/COUNT(1),2) FROM electives;</span><br><span class="line">/*ROUNDå‡½æ•° å°†æ•°å­—å››èˆäº”å…¥åˆ°æŒ‡å®šçš„ä½æ•°ã€‚*/</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/6494641a1ddac507cc52bb8a.jpg"></p>
<h3 id="cã€æ¯é—¨è¯¾ç¨‹çš„å¹³å‡åˆ†ï¼Œè¦æ±‚æ˜¾ç¤ºå‡ºè¯¾ç¨‹çš„ä¸­æ–‡åå­—"><a href="#cã€æ¯é—¨è¯¾ç¨‹çš„å¹³å‡åˆ†ï¼Œè¦æ±‚æ˜¾ç¤ºå‡ºè¯¾ç¨‹çš„ä¸­æ–‡åå­—" class="headerlink" title="cã€æ¯é—¨è¯¾ç¨‹çš„å¹³å‡åˆ†ï¼Œè¦æ±‚æ˜¾ç¤ºå‡ºè¯¾ç¨‹çš„ä¸­æ–‡åå­—"></a>cã€æ¯é—¨è¯¾ç¨‹çš„å¹³å‡åˆ†ï¼Œè¦æ±‚æ˜¾ç¤ºå‡ºè¯¾ç¨‹çš„ä¸­æ–‡åå­—</h3><p>æ–¹æ³•ä¸€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TEMPORARY TABLE temp3 AS</span><br><span class="line">    SELECT COURSE_CLASS_CODE,SPLIT(COURSE_CLASS_CODE, &#x27;\\.&#x27;)[0] AS code,avg(score) AS avg1 </span><br><span class="line">    from electives </span><br><span class="line">    group by COURSE_CLASS_CODE;</span><br><span class="line"></span><br><span class="line">SELECT t1.code,avg(avg1),t2.NAME</span><br><span class="line">FROM temp3 t1,course t2</span><br><span class="line">WHERE t1.code=t2.CODE</span><br><span class="line">GROUP BY t1.code,t2.NAME;</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/649464251ddac507cc52c9f7.jpg"></p>
<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/*éä¸¥æ ¼æ¨¡å¼*/</span><br><span class="line">SELECT t2.NAME,ROUND(AVG(SCORE),2) AS avg_score</span><br><span class="line">FROM electives t1,course t2,course_class t3</span><br><span class="line">WHERE</span><br><span class="line">t1.COURSE_CLASS_CODE = t3.CODE AND</span><br><span class="line">t2.CODE = t3.COURSE_CODE</span><br><span class="line">GROUP BY t2.NAME;</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/6494642f1ddac507cc52d8be.jpg"></p>
<p>æ–¹æ³•ä¸‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT t2.NAME,ROUND(AVG(SCORE),2)AS avg_score FROM electives t1</span><br><span class="line">LEFT JOIN course_class t3 ON t1.COURSE_CLASS_CODE=t3.CODE</span><br><span class="line">LEFT JOIN course t2 ON t2.CODE=t3.COURSE_CODE</span><br><span class="line">GROUP BY t2.NAME;</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/6494643b1ddac507cc52ea67.jpg"></p>
<p>æ–¹æ³•å››ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT t1.COURSE_CLASS_CODE,t2.NAME,t1.avg_score</span><br><span class="line">FROM</span><br><span class="line">(SELECT COURSE_CLASS_CODE,ROUND(AVG(SCORE),2)AS avg_score FROM electives GROUP BY COURSE_CLASS_CODE)t1</span><br><span class="line">LEFT JOIN course_class t3 ON t1.COURSE_CLASS_CODE=t3.CODE</span><br><span class="line">LEFT JOIN course t2 ON t2.CODE=t3.COURSE_CODE;</span><br><span class="line"></span><br><span class="line">/*FULL OUTER,LEFT ,RIGHT,CROSS JOIN éƒ½å¯ä»¥*/</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/6494644a1ddac507cc5302c9.jpg"></p>
<h3 id="dã€æœ‰2é—¨è¯¾ä¸åŠæ ¼çš„å­¦ç”Ÿï¼ˆé‡ä¿®çš„å­¦ç”Ÿï¼‰"><a href="#dã€æœ‰2é—¨è¯¾ä¸åŠæ ¼çš„å­¦ç”Ÿï¼ˆé‡ä¿®çš„å­¦ç”Ÿï¼‰" class="headerlink" title="dã€æœ‰2é—¨è¯¾ä¸åŠæ ¼çš„å­¦ç”Ÿï¼ˆé‡ä¿®çš„å­¦ç”Ÿï¼‰"></a>dã€æœ‰2é—¨è¯¾ä¸åŠæ ¼çš„å­¦ç”Ÿï¼ˆé‡ä¿®çš„å­¦ç”Ÿï¼‰</h3><p>æ–¹æ³•ä¸€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TEMPORARY TABLE temp4 AS</span><br><span class="line">    SELECT STUDENT_ID,count(*) AS count1</span><br><span class="line">    FROM electives</span><br><span class="line">    WHERE SCORE&lt;60</span><br><span class="line">    GROUP BY STUDENT_ID;</span><br><span class="line"></span><br><span class="line">SELECT t1.NAME,t2.count1</span><br><span class="line">FROM students t1,temp4 t2</span><br><span class="line">WHERE t1.ID=t2.STUDENT_ID AND count1&gt;=2;/*æœ‰2é—¨è¯¾ä¸åŠæ ¼çš„å­¦ç”Ÿï¼ˆé‡ä¿®çš„å­¦ç”Ÿï¼‰ æ‰€ä»¥æ˜¯&gt;=2*/</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/649464531ddac507cc53134d.jpg"></p>
<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT t1.STUDENT_ID,t2.NAME,t1.score</span><br><span class="line">FROM</span><br><span class="line">(SELECT STUDENT_ID,SUM(IF(SCORE&lt;60,1,0))AS score FROM electives GROUP BY STUDENT_ID HAVING score&gt;=2)t1</span><br><span class="line">LEFT JOIN student t2 ON t2.ID=t1.STUDENT_ID;</span><br><span class="line">/*å§“åä¼šæ˜¾ç¤ºå¤±è´¥ï¼Œæš‚æ—¶æ²¡æœ‰è§£å†³*/</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/6494645d1ddac507cc532208.jpg"></p>
<h3 id="eã€è¯¾ç¨‹çš„åŠæ ¼ç‡ï¼ŒåŒæ—¶è¦æ˜¾ç¤ºè€å¸ˆçš„åå­—ï¼ˆç»©æ•ˆè€ƒæ ¸ï¼‰"><a href="#eã€è¯¾ç¨‹çš„åŠæ ¼ç‡ï¼ŒåŒæ—¶è¦æ˜¾ç¤ºè€å¸ˆçš„åå­—ï¼ˆç»©æ•ˆè€ƒæ ¸ï¼‰" class="headerlink" title="eã€è¯¾ç¨‹çš„åŠæ ¼ç‡ï¼ŒåŒæ—¶è¦æ˜¾ç¤ºè€å¸ˆçš„åå­—ï¼ˆç»©æ•ˆè€ƒæ ¸ï¼‰"></a>eã€è¯¾ç¨‹çš„åŠæ ¼ç‡ï¼ŒåŒæ—¶è¦æ˜¾ç¤ºè€å¸ˆçš„åå­—ï¼ˆç»©æ•ˆè€ƒæ ¸ï¼‰</h3><p>æ–¹æ³•ä¸€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/*è¯¾ç¨‹å¹³å‡åˆ†ç»©æ•ˆ*/</span><br><span class="line">CREATE TEMPORARY TABLE temp5 AS</span><br><span class="line">    SELECT t1.COURSE_CLASS_CODE,t2.TEACHER_ID AS ID1,avg(t1.score) AS avg1 </span><br><span class="line">    FROM electives t1,course_class t2</span><br><span class="line">    WHERE t1.COURSE_CLASS_CODE=t2.CODE</span><br><span class="line">    GROUP BY t1.COURSE_CLASS_CODE,t2.TEACHER_ID</span><br><span class="line">    ORDER BY t2.TEACHER_ID;</span><br><span class="line"></span><br><span class="line">SELECT t1.COURSE_CLASS_CODE,t1.ID1,t2.NAME,t1.avg1</span><br><span class="line">FROM temp5 t1,teacher t2</span><br><span class="line">WHERE t1.ID1=t2.ID;</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/649464671ddac507cc53313c.jpg"></p>
<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT t1.COURSE_CLASS_CODE,t1.per,t3.NAME</span><br><span class="line">FROM</span><br><span class="line">(SELECT COURSE_CLASS_CODE,ROUND(SUM(IF(SCORE&gt;=60,1,0))/COUNT(*),4) AS per</span><br><span class="line">FROM electives</span><br><span class="line">GROUP BY COURSE_CLASS_CODE)t1</span><br><span class="line">LEFT JOIN course_class t2 ON t1.COURSE_CLASS_CODE=t2.CODE</span><br><span class="line">LEFT JOIN teacher t3 on t2.teacher_id = ID</span><br><span class="line">ORDER BY t3.NAME;</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/649464711ddac507cc533f1c.jpg"></p>
<h3 id="fã€è€å¸ˆæ•™äº†å‡ é—¨è¯¾"><a href="#fã€è€å¸ˆæ•™äº†å‡ é—¨è¯¾" class="headerlink" title="fã€è€å¸ˆæ•™äº†å‡ é—¨è¯¾"></a>fã€è€å¸ˆæ•™äº†å‡ é—¨è¯¾</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT t1.NAME AS TEACHER_NAME, COUNT(t2.COURSE_CODE) </span><br><span class="line">FROM teacher t1</span><br><span class="line">JOIN course_class t2 ON t1.ID = t2.TEACHER_ID</span><br><span class="line">GROUP BY t1.NAME;</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/6494647b1ddac507cc534da1.jpg"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/*æœ€åè¦è®°å¾—*/</span><br><span class="line">stop-all.sh</span><br></pre></td></tr></table></figure>



                            <!-- Meta -->
                            <div class="post-meta">
                                <hr>
                                <br>
                                <div class="post-tags">
                                    
                                        

<a href="/tags/ç¼–ç¨‹/">#ç¼–ç¨‹</a> <a href="/tags/Hadoop/">#Hadoop</a> <a href="/tags/Hive/">#Hive</a> <a href="/tags/å¤§æ•°æ®å¹³å°æ ¸å¿ƒæŠ€æœ¯/">#å¤§æ•°æ®å¹³å°æ ¸å¿ƒæŠ€æœ¯</a>


                                            
                                </div>
                                <div class="post-date">
                                    
                                        2023-04-28
                                    
                                </div>
                            </div>
                    </div>

                    <!-- Comments -->
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <!-- Disqus Comments -->


                    </div>
                </div>
            </div>
        </article>
</section>

<!-- Image viewer-->

    <!-- Custom picture view-->
    <link href="/css/viewer.min.css" rel="stylesheet" />
    <script
      src="/js/viewer.min.js"
      type="text/javascript"
      charset="utf-8"
    ></script>
    
    <script type="text/javascript">
      // set image viewer
      Viewer.setDefaults({
        zoomRatio: [0.5],
        navbar: false,
        toolbar: false,
        button: false,
        title: [2, (image, imageData) => `${image.alt}`],
        show: function() {
          this.viewer.zoomTo(0.5);
        }
      });
      var imageList = document.getElementsByTagName("img");
      Array.prototype.forEach.call(imageList, element => {
        var viewer = new Viewer(element);
      });
    </script>

    

<!-- TOC -->

    <aside id="article-toc" role="navigation" class="fixed">
        <div id="article-toc-inner">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%B5%84%E6%96%99%E5%87%86%E5%A4%87"><span class="toc-text">1.èµ„æ–™å‡†å¤‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%97%A5%E5%B8%B8%E6%93%8D%E4%BD%9C"><span class="toc-text">2.æ—¥å¸¸æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E5%90%AF%E5%8A%A8%E3%80%81%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-text">ï¼ˆ1ï¼‰å¯åŠ¨ã€æ–°å»ºæ–‡ä»¶å¤¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89copyFromLocal"><span class="toc-text">ï¼ˆ2ï¼‰copyFromLocal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E5%BB%BA%E8%A1%A8"><span class="toc-text">ï¼ˆ3ï¼‰å»ºè¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E9%A2%98%E7%9B%AE-%E5%8E%BB%E8%A1%A8%E5%A4%B4"><span class="toc-text">ï¼ˆ4ï¼‰é¢˜ç›®[å»è¡¨å¤´]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%A7%A3%E9%A2%98"><span class="toc-text">3.è§£é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#a%E3%80%81%E7%94%B7%E5%A5%B3%E7%94%9F%E6%AF%94%E4%BE%8B"><span class="toc-text">aã€ç”·å¥³ç”Ÿæ¯”ä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#b%E3%80%81%E5%AD%A6%E7%94%9F%E6%95%B4%E4%BD%93%E5%8F%8A%E6%A0%BC%E7%8E%87"><span class="toc-text">bã€å­¦ç”Ÿæ•´ä½“åŠæ ¼ç‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#c%E3%80%81%E6%AF%8F%E9%97%A8%E8%AF%BE%E7%A8%8B%E7%9A%84%E5%B9%B3%E5%9D%87%E5%88%86%EF%BC%8C%E8%A6%81%E6%B1%82%E6%98%BE%E7%A4%BA%E5%87%BA%E8%AF%BE%E7%A8%8B%E7%9A%84%E4%B8%AD%E6%96%87%E5%90%8D%E5%AD%97"><span class="toc-text">cã€æ¯é—¨è¯¾ç¨‹çš„å¹³å‡åˆ†ï¼Œè¦æ±‚æ˜¾ç¤ºå‡ºè¯¾ç¨‹çš„ä¸­æ–‡åå­—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#d%E3%80%81%E6%9C%892%E9%97%A8%E8%AF%BE%E4%B8%8D%E5%8F%8A%E6%A0%BC%E7%9A%84%E5%AD%A6%E7%94%9F%EF%BC%88%E9%87%8D%E4%BF%AE%E7%9A%84%E5%AD%A6%E7%94%9F%EF%BC%89"><span class="toc-text">dã€æœ‰2é—¨è¯¾ä¸åŠæ ¼çš„å­¦ç”Ÿï¼ˆé‡ä¿®çš„å­¦ç”Ÿï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e%E3%80%81%E8%AF%BE%E7%A8%8B%E7%9A%84%E5%8F%8A%E6%A0%BC%E7%8E%87%EF%BC%8C%E5%90%8C%E6%97%B6%E8%A6%81%E6%98%BE%E7%A4%BA%E8%80%81%E5%B8%88%E7%9A%84%E5%90%8D%E5%AD%97%EF%BC%88%E7%BB%A9%E6%95%88%E8%80%83%E6%A0%B8%EF%BC%89"><span class="toc-text">eã€è¯¾ç¨‹çš„åŠæ ¼ç‡ï¼ŒåŒæ—¶è¦æ˜¾ç¤ºè€å¸ˆçš„åå­—ï¼ˆç»©æ•ˆè€ƒæ ¸ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#f%E3%80%81%E8%80%81%E5%B8%88%E6%95%99%E4%BA%86%E5%87%A0%E9%97%A8%E8%AF%BE"><span class="toc-text">fã€è€å¸ˆæ•™äº†å‡ é—¨è¯¾</span></a></li></ol></li></ol>
        </div>
    </aside>

    <!-- Scripts -->
    <script type="text/javascript">
    console.log("Â© zchen9 ğŸ™‹ 2015-" + new Date().getFullYear());
</script>
  
    <!-- Google Analytics -->
    

    <!-- Service Worker -->
    <!-- if using service worker -->

    
</body>

</html>